{% extends 'base.html' %}
{% block main %}
    <form method="post" id="data">
        {% csrf_token %}
        {{ form }}
        <input type="submit" value="Shorten URL">
    </form>
    
    <p id="url"></p>
    
    
    <script>
        $("form#data").submit(function(e) {
            e.preventDefault();    
            let formData = new FormData(this);
        
            $.ajax({
                url: `http://127.0.0.1:8000/api/shorturl/`,
                type: 'POST',
                data: formData,
                success: function (response) {
                    $("#url").text("Your shortened url is: " + response.url);
                },
                error: function (response){
                    alert(response);
                },
                cache: false,
                contentType: false,
                processData: false
            });
        });
    </script>
{% endblock %}